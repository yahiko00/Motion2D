var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)};!function(t){if("object"==typeof module&&"object"==typeof module.exports){var e=t(require,exports);void 0!==e&&(module.exports=e)}else"function"==typeof define&&define.amd&&define(["require","exports","geometry2d/dist/geometry2d","hitbox2d/dist/hitbox2d"],t)}(function(t,e){"use strict";var i=t("geometry2d/dist/geometry2d"),o=t("hitbox2d/dist/hitbox2d");Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;var a;!function(t){var e=function(){function t(t,e,i,o,a){this.x=t,this.y=e,this.velocity={x:0,y:0},this.maxSpeed=i,this.hitbox=a,this.direction=o}return t.prototype.setMaxSpeed=function(t){return this.maxSpeed=t,this.maxSpeed},t.prototype.setDirection=function(t){return this.direction=t},t.prototype.setVelocity=function(t){return this.velocity=i.default.limitVector(t,this.maxSpeed),i.default.lengthSqVector(this.velocity)>i.default.EPSILON&&(this.direction=i.default.unitVectorToAngle(i.default.normalizeVector(this.velocity))),this.velocity},t.prototype.updatePosition=function(){this.x+=this.velocity.x,this.y+=this.velocity.y,this.hitbox.x=this.x,this.hitbox.y=this.y},t.prototype.moveXY=function(t,e){void 0===e&&(e=this.maxSpeed),this.setVelocity(i.default.multVectorByScalar(t,Math.min(e,this.maxSpeed)))},t.prototype.moveToDirection=function(t){void 0===t&&(t=this.maxSpeed);var e=i.default.angleToUnitVector(this.direction);this.moveXY(e,t)},t.prototype.moveToPoint=function(t,e){void 0===e&&(e=this.maxSpeed),this.moveXY(i.default.normalizeVector(i.default.subVectors(t,this)),e)},t.prototype.stop=function(){this.setVelocity(i.default.NULL_VEC)},t.prototype.setDirectionToPoint=function(t){var e={x:t.x-this.x,y:t.y-this.y};this.direction=i.default.unitVectorToAngle(i.default.normalizeVector(e))},t.prototype.getSpeed=function(){return i.default.lengthVector(this.velocity)},t}();t.Mobile=e;var a=function(t){function a(e,o,a,r,s,c,d,n){void 0===c&&(c=1),void 0===n&&(n=0),t.call(this,e,o,a,r,s),this.mass=c,this.acceleration=i.default.NULL_VEC,this.path=d||null,this.currentPathNode=n,this.pathDirection=1}return __extends(a,t),a.prototype.updatePosition=function(){t.prototype.updatePosition.call(this),this.acceleration=i.default.NULL_VEC},a.prototype.updateVelocity=function(){this.acceleration=i.default.limitVector(this.acceleration,this.maxSpeed),this.acceleration=i.default.divVectorByScalar(this.acceleration,this.mass),this.setVelocity(i.default.addVectors(this.velocity,this.acceleration))},a.prototype.nextVelocity=function(){var t={x:this.acceleration.x,y:this.acceleration.y};return t=i.default.limitVector(t,this.maxSpeed),t=i.default.divVectorByScalar(t,this.mass),i.default.addVectors(this.velocity,t)},a.prototype.stop=function(){t.prototype.stop.call(this),this.acceleration=i.default.NULL_VEC},a.prototype.flee=function(t){var e=i.default.limitVector(i.default.subVectors(this,t),this.maxSpeed);this.acceleration=i.default.addVectors(this.acceleration,i.default.subVectors(e,this.velocity))},a.prototype.seek=function(t){var e=i.default.limitVector(i.default.subVectors(t,this),this.maxSpeed);this.acceleration=i.default.addVectors(this.acceleration,i.default.subVectors(e,this.velocity))},a.prototype.seekArrival=function(t,e){var o=i.default.limitVector(i.default.subVectors(t,this),this.maxSpeed),a=i.default.distance(this,t);a<=e&&(o=i.default.multVectorByScalar(o,this.maxSpeed*a/e)),this.acceleration=i.default.addVectors(this.acceleration,i.default.subVectors(o,this.velocity))},a.prototype.seekRandomPoint=function(t,e){var i={x:Math.random()*t,y:Math.random()*e};this.seek(i)},a.prototype.pursuit=function(t,e,o){void 0===o&&(o=3);var a=i.default.addVectors(t,i.default.multVectorByScalar(t.velocity,o));this.seekArrival(a,e)},a.prototype.adaptativePursuit=function(t,e){var o=i.default.distance(this,t)/t.maxSpeed,a=i.default.addVectors(t,i.default.multVectorByScalar(t.velocity,o));this.seekArrival(a,e)},a.prototype.evade=function(t,e){void 0===e&&(e=3);var o=i.default.addVectors(t,i.default.multVectorByScalar(t.velocity,e));this.flee(o)},a.prototype.adaptativeEvade=function(t){var e=i.default.distance(this,t)/t.maxSpeed,o=i.default.addVectors(t,i.default.multVectorByScalar(t.velocity,e));this.flee(o)},a.prototype.avoidObstacles=function(t){var e=i.default.NULL_VEC,o=0;i.default.isCircle(this.hitbox)?o=this.hitbox.radius:i.default.isAABox(this.hitbox)&&(o=Math.max(this.hitbox.halfDimX,this.hitbox.halfDimY));var a=this.getAheadDistance(),r=i.default.addVectors(this,i.default.scaleVector(this.velocity,a)),s=i.default.addVectors(this,i.default.scaleVector(this.velocity,a/2)),c=this,d=this.findMostThreateningObstacle(r,s,c,t);return d&&(e=i.default.scaleVector(i.default.subVectors(r,d),this.maxSpeed)),this.acceleration=i.default.addVectors(this.acceleration,e),{ahead:r,ahead2:s,ahead3:c,mostThreateningObstacle:d,avoidance:e}},a.prototype.getAheadDistance=function(){var t=0;return t=i.default.isCircle(this.hitbox)?this.hitbox.radius*(1+i.default.lengthVector(this.velocity)):Math.max(this.hitbox.halfDimX,this.hitbox.halfDimY)*(1+i.default.lengthVector(this.velocity))},a.prototype.getAheadArea=function(t){void 0===t&&(t=this.getAheadDistance());var o=i.default.addVectors(this,i.default.scaleVector(this.velocity,t)),a=new e(o.x,o.y,this.maxSpeed,this.direction,{x:o.x,y:o.y,radius:t});return a.setVelocity(this.velocity),a},a.prototype.findMostThreateningObstacle=function(t,e,a,r){for(var s=null,c=0;c<r.length;c++){var d=r[c];if(d!==this){var n=o.default.pointInHitbox(t,d.hitbox)||o.default.pointInHitbox(e,d.hitbox)||o.default.pointInHitbox(a,d.hitbox);n&&(!s||i.default.distance(this,d)<i.default.distance(this,s))&&(s=d)}}return s},a.prototype.followPath=function(t,e){if(void 0===e&&(e=!1),this.path&&this.path.length>0){var o=this.path[this.currentPathNode];if(this.seek(o),i.default.distanceSq(this,o)<=t*t&&(this.currentPathNode+=this.pathDirection,this.currentPathNode>=this.path.length||this.currentPathNode<0)){if(!e)return this.currentPathNode=this.path.length-1,!0;this.pathDirection*=-1,this.currentPathNode+=this.pathDirection}}return!1},a.prototype.moveAround=function(t,e,o){void 0===o&&(o=!0);var a=-1;o||(a=1);var r=i.default.subVectors(this,t),s=i.default.scaleVector(r,e),c=i.default.subVectors(s,r),d=i.default.scaleVector(i.default.tangentUnitVectorCircle({x:t.x,y:t.y,radius:e},this),a*this.maxSpeed);this.acceleration=i.default.addVectors(this.acceleration,i.default.subVectors(c,this.velocity)),this.acceleration=i.default.addVectors(this.acceleration,i.default.subVectors(d,this.velocity))},a.prototype.moveFront=function(t,e){var o=i.default.angleToUnitVector(t.direction),a=i.default.subVectors(t,this),r=t.direction,s=i.default.unitVectorToAngle(i.default.normalizeVector(a));if(Math.abs(Math.abs(r-s)-Math.PI)<.01)return!0;var c=i.default.detVectors(o,a),d=c>0;return this.moveAround(t,e,d),!1},a.prototype.moveBehind=function(t,e){var o=i.default.angleToUnitVector(t.direction),a=i.default.subVectors(t,this),r=t.direction,s=i.default.unitVectorToAngle(i.default.normalizeVector(a));if(Math.abs(r-s)<.01)return!0;var c=i.default.detVectors(o,a),d=c<=0;return this.moveAround(t,e,d),!1},a}(e);t.SteeringMobile=a}(a||(a={}))});
//# sourceMappingURL=dist/motion2d.min.js.map